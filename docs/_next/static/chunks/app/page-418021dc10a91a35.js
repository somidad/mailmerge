(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4399:function(e,t,n){Promise.resolve().then(n.bind(n,3353))},3353:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return U}});var a=n(7437),r=n(2265),s=n(5241),l=n(7592),i=n(2468),o=n(8165),d=n(4839),c=n(6164);function u(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,c.m6)((0,d.W)(t))}let f=s.v2;s.ZA,s.h_,s.Tr,s.Ee;let m=r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)(s.fC,{ref:t,className:u("flex h-10 items-center space-x-1 rounded-md border bg-background p-1",n),...r})});m.displayName=s.fC.displayName;let h=r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)(s.xz,{ref:t,className:u("flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",n),...r})});h.displayName=s.xz.displayName,r.forwardRef((e,t)=>{let{className:n,inset:r,children:i,...o}=e;return(0,a.jsxs)(s.fF,{ref:t,className:u("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",r&&"pl-8",n),...o,children:[i,(0,a.jsx)(l.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=s.fF.displayName,r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)(s.tu,{ref:t,className:u("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...r})}).displayName=s.tu.displayName,r.forwardRef((e,t)=>{let{className:n,align:r="start",alignOffset:l=-4,sideOffset:i=8,...o}=e;return(0,a.jsx)(s.h_,{children:(0,a.jsx)(s.VY,{ref:t,align:r,alignOffset:l,sideOffset:i,className:u("z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...o})})}).displayName=s.VY.displayName,r.forwardRef((e,t)=>{let{className:n,inset:r,...l}=e;return(0,a.jsx)(s.ck,{ref:t,className:u("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r&&"pl-8",n),...l})}).displayName=s.ck.displayName,r.forwardRef((e,t)=>{let{className:n,children:r,checked:l,...o}=e;return(0,a.jsxs)(s.oC,{ref:t,className:u("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),checked:l,...o,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(s.wU,{children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})}),r]})}).displayName=s.oC.displayName,r.forwardRef((e,t)=>{let{className:n,children:r,...l}=e;return(0,a.jsxs)(s.Rk,{ref:t,className:u("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(s.wU,{children:(0,a.jsx)(o.Z,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=s.Rk.displayName,r.forwardRef((e,t)=>{let{className:n,inset:r,...l}=e;return(0,a.jsx)(s.__,{ref:t,className:u("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",n),...l})}).displayName=s.__.displayName,r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)(s.Z0,{ref:t,className:u("-mx-1 my-1 h-px bg-muted",n),...r})}).displayName=s.Z0.displayName;var x=n(7170),p=n(7818),j=n(9470),b=n.n(j),g=n(3304),y=n(2218),N=n(4697);let w=g.fC;g.xz,g.x8;let v=g.h_,k=r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)(g.aV,{className:u("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...r,ref:t})});k.displayName=g.aV.displayName;let R=(0,y.j)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),S=r.forwardRef((e,t)=>{let{side:n="right",className:r,children:s,...l}=e;return(0,a.jsxs)(v,{children:[(0,a.jsx)(k,{}),(0,a.jsxs)(g.VY,{ref:t,className:u(R({side:n}),r),...l,children:[s,(0,a.jsxs)(g.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,a.jsx)(N.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});S.displayName=g.VY.displayName;let O=e=>{let{className:t,...n}=e;return(0,a.jsx)("div",{className:u("flex flex-col space-y-2 text-center sm:text-left",t),...n})};O.displayName="SheetHeader";let C=r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)(g.Dx,{ref:t,className:u("text-lg font-semibold text-foreground",n),...r})});C.displayName=g.Dx.displayName,r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)(g.dk,{ref:t,className:u("text-sm text-muted-foreground",n),...r})}).displayName=g.dk.displayName;let A=r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)("textarea",{className:u("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:t,...r})});function z(e){let{open:t,onOpenChange:n,data:r}=e;return(0,a.jsx)(w,{open:t,onOpenChange:n,children:(0,a.jsxs)(S,{className:"flex flex-col",children:[(0,a.jsx)(O,{children:(0,a.jsx)(C,{children:"Data"})}),(0,a.jsx)("div",{className:"grow",children:(0,a.jsx)(A,{className:"h-full",readOnly:!0,value:r})})]})})}function _(e){let{children:t}=e;return(0,a.jsx)("h1",{className:"scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl",children:t})}function W(e){let{children:t}=e;return(0,a.jsx)("h2",{className:"scroll-m-20 border-b pb-2 text-3xl font-semibold tracking-tight first:mt-0",children:t})}function F(e){let{children:t}=e;return(0,a.jsx)("h3",{className:"scroll-m-20 text-2xl font-semibold tracking-tight",children:t})}function J(e){let{children:t}=e;return(0,a.jsx)("h4",{className:"scroll-m-20 text-xl font-semibold tracking-tight",children:t})}function Y(e){let{children:t}=e;return(0,a.jsx)("p",{className:"leading-7 [&:not(:first-child)]:mt-6",children:t})}function q(e){let{children:t}=e;return(0,a.jsx)("ul",{className:"my-6 ml-6 list-disc [&>li]:mt-2",children:t})}function E(e){let{children:t}=e;return(0,a.jsx)("ol",{className:"my-6 ml-6 list-decimal [&>li]:mt-2",children:t})}function P(e){let{children:t}=e;return(0,a.jsx)("code",{className:"relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono text-sm font-semibold",children:t})}function T(e){let{children:t}=e;return(0,a.jsx)("blockquote",{className:"mt-6 border-l-2 pl-6 italic",children:t})}function V(e){return{h1:e=>{let{children:t}=e;return(0,a.jsx)(_,{children:t})},h2:e=>{let{children:t}=e;return(0,a.jsx)(W,{children:t})},h3:e=>{let{children:t}=e;return(0,a.jsx)(F,{children:t})},h4:e=>{let{children:t}=e;return(0,a.jsx)(J,{children:t})},p:e=>{let{children:t}=e;return(0,a.jsx)(Y,{children:t})},blockquote:e=>{let{children:t}=e;return(0,a.jsx)(T,{children:t})},ul:e=>{let{children:t}=e;return(0,a.jsx)(q,{children:t})},ol:e=>{let{children:t}=e;return(0,a.jsx)(E,{children:t})},code:e=>{let{children:t}=e;return(0,a.jsx)(P,{children:t})},pre:e=>{let{children:t}=e;return(0,a.jsx)("pre",{className:"bg-muted",children:t})},...e}}function Z(e){let t={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...V(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h2,{children:"Mailmerge"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"Write once, publish to everyone"}),"\n"]}),"\n",(0,a.jsx)(t.h3,{children:"Workflow"}),"\n",(0,a.jsx)(t.p,{children:"Like any other mailmerge, the following workflow can apply:"}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsx)(t.li,{children:"Define and load data"}),"\n",(0,a.jsxs)(t.li,{children:["Write down a ",(0,a.jsx)(t.em,{children:"template"})]}),"\n",(0,a.jsx)(t.li,{children:"Publish"}),"\n"]}),"\n",(0,a.jsx)(t.h3,{children:"Defining and loading data"}),"\n",(0,a.jsxs)(t.p,{children:["Data for mailmerge must be in ",(0,a.jsx)(t.em,{children:"JSON"})," format.\nThere must be a top-level ",(0,a.jsx)(t.em,{children:"Array"}),", starting with ",(0,a.jsx)(t.code,{children:"["})," and ending with ",(0,a.jsx)(t.code,{children:"]"}),".\nAnd each item must be an ",(0,a.jsx)(t.em,{children:"Object"}),", starting with ",(0,a.jsx)(t.code,{children:"{"})," and ending with ",(0,a.jsx)(t.code,{children:"}"}),", with ",(0,a.jsx)(t.code,{children:"key"})," property."]}),"\n",(0,a.jsx)(t.p,{children:"Here is the simplest example:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:'[\n  {\n    "key": "Alice"\n  },\n  {\n    "key": "Bob"\n  }\n]\n'})}),"\n",(0,a.jsxs)(t.p,{children:["With this data, mailmerge will render two documents for ",(0,a.jsx)(t.code,{children:"Alice"})," and ",(0,a.jsx)(t.code,{children:"Bob"})," each."]}),"\n",(0,a.jsx)(t.p,{children:"Now you can define any property in each Object as long as it complies JSON format."}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsxs)(t.p,{children:['For more information about JSON format,\nfee "JSON structure" section of\n',(0,a.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/JSON#json_structure",children:"this document by Mozilla"})]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"When the data is ready, you can load and view it via 'Load data' and 'Show data' menu."}),"\n",(0,a.jsx)(t.h3,{children:"Writing a template"}),"\n",(0,a.jsx)(t.p,{children:"You can write a template by using the WYSIWYG editor."}),"\n",(0,a.jsxs)(t.p,{children:["You may want to use ",(0,a.jsx)(t.em,{children:"template delimiters"})," for 'data dependent' content:"]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"{{=it.key}}"})," prints a value of ",(0,a.jsx)(t.code,{children:"key"})," property of data"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"{{? condition }} content {{?}}"})," renders a following content only if ",(0,a.jsx)(t.code,{children:"condition"})," is evaulated to be true. For example:"]}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:'{{? it.key == "Alice" }}\nSee you again, Alice!\n{{?}}\n'})}),"\n",(0,a.jsxs)(t.p,{children:["renders ",(0,a.jsx)(t.em,{children:"See you again, Alice!"})," only for data with ",(0,a.jsx)(t.code,{children:"key"})," Alice."]}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsxs)(t.p,{children:["For more information about template delimiters,\nfind 'default delimiters' in\n",(0,a.jsx)(t.a,{href:"https://olado.github.io/doT/index.html",children:"doT.js official document"})]}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["Here, you may take ",(0,a.jsx)(t.code,{children:"it."})," as an individual data container for each publication so\nyou may want to use it everytime that you access to data.\nYou can use ",(0,a.jsx)(t.code,{children:".keyName"})," to access a value of ",(0,a.jsx)(t.code,{children:"keyName"})," property of an Object and\n",(0,a.jsx)(t.code,{children:"[i]"})," to access a value of ",(0,a.jsx)(t.em,{children:"i"})," th (0-indexed) item of an Array."]}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsxs)(t.p,{children:["For more information about accessing data of an object and an array,\nsee ",(0,a.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object",children:"Object"})," and\n",(0,a.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array",children:"Array"})," by Mozilla"]}),"\n"]}),"\n",(0,a.jsx)(t.h3,{children:"Publishing"}),"\n",(0,a.jsx)(t.p,{children:"Press 'Publish' and documents will be downloaded shortly."})]})}function D(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:t}={...V(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(Z,{...e})}):Z(e)}A.displayName="Textarea";let H=(0,p.default)(()=>Promise.all([n.e(459),n.e(771)]).then(n.bind(n,3771)),{loadableGenerated:{webpack:()=>[3771]},ssr:!1});function U(){let e=(0,r.useRef)(null),[t,n]=(0,r.useState)(""),s=(0,r.useRef)(null),[l,i]=(0,r.useState)("[]"),[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)("edit");return(0,a.jsxs)("div",{children:[(0,a.jsxs)(m,{children:[(0,a.jsx)(f,{children:(0,a.jsx)(h,{onClick:()=>n(""),children:"New"})}),(0,a.jsxs)(f,{children:[(0,a.jsx)(h,{onClick:()=>{var t;return null===(t=e.current)||void 0===t?void 0:t.click()},children:"Open"}),(0,a.jsx)("input",{type:"file",ref:e,hidden:!0,onChange:function(t){var a;let r=null===(a=t.target.files)||void 0===a?void 0:a[0];if(r){let t=new FileReader;t.onload=e=>{e.target&&n(e.target.result)},t.readAsText(r),e.current&&(e.current.value="")}}})]}),(0,a.jsx)(f,{children:(0,a.jsx)(h,{onClick:function(){let e=new Blob([t],{type:"text/plain;charset=utf-8"});(0,x.saveAs)(e)},children:"Save"})}),(0,a.jsxs)(f,{children:[(0,a.jsx)(h,{onClick:()=>{var e;return null===(e=s.current)||void 0===e?void 0:e.click()},children:"Load data"}),(0,a.jsx)("input",{type:"file",ref:s,hidden:!0,onChange:function(e){var t;let n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n){let e=new FileReader;e.onload=e=>{e.target&&i(e.target.result)},e.readAsText(n),s.current&&(s.current.value="")}}})]}),(0,a.jsx)(f,{children:(0,a.jsx)(h,{onClick:()=>d(e=>!e),children:o?"Hide data":"Show data"})}),(0,a.jsx)(f,{children:(0,a.jsx)(h,{onClick:function(){let e=b().template(t),n=JSON.parse(l),a=[];n.forEach(t=>{let n=e(t),r=a.find(e=>e.rendered===n);r?r.keys.push(t.key):a.push({keys:[t.key],rendered:n})}),a.forEach(e=>{let{keys:t,rendered:n}=e,a=new Blob([n],{type:"text/html;charset=utf-8"});(0,x.saveAs)(a,"".concat(t.join(", "),".html"))})},children:"Publish"})}),(0,a.jsx)(f,{children:(0,a.jsx)(h,{onClick:()=>{u(e=>"edit"===e?"help":"edit")},children:"edit"===c?"Help":"Edit"})})]}),"edit"===c?(0,a.jsx)(H,{data:t,onChange:n}):(0,a.jsx)("div",{className:"p-2",children:(0,a.jsx)(D,{})}),(0,a.jsx)(z,{open:o,onOpenChange:d,data:l})]})}}},function(e){e.O(0,[191,971,23,744],function(){return e(e.s=4399)}),_N_E=e.O()}]);